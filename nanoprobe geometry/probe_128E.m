%breakable probe
%1 or 4; 2 or 3; 5 or 8; 6 or 7.
%e.g. a probe with shaft 1, 3, 8, 7 would be called 128E_1387

exceldata=[];

exceldata=[
    
         103          10        1750           1
         102          10        1800           1
         101          10        1850           1
         100          10        1900           1
          99          10        1950           1
          98          10        2000           1
          97          10        2050           1
         104          10        2100           1
         105          10        2150           1
         106          10        2200           1
         107          10        2250           1
         108          10        2300           1
         109          10        2350           1
         110          10        1700           1
         111          10        1650           1
         112           0        1600           1
         113          -6        1625           1
         114         -10        1675           1
         115         -10        1725           1
         116         -10        2375           1
         117         -10        2325           1
         118         -10        2275           1
         119         -10        2225           1
         120         -10        2175           1
         121         -10        2125           1
         122         -10        2075           1
         123         -10        2025           1
         124         -10        1975           1
         125         -10        1925           1
         126         -10        1875           1
         127         -10        1825           1
         128         -10        1775           1
          65        -240        1750           2
          66        -240        1800           2
          67        -240        1850           2
          68        -240        1900           2
          69        -240        1950           2
          70        -240        2000           2
          71        -240        2050           2
          72        -240        2100           2
          73        -240        2150           2
          74        -240        2200           2
          75        -240        2250           2
          76        -240        2300           2
          77        -240        2350           2
          78        -240        1700           2
          79        -240        1650           2
          80        -250        1600           2
          81        -256        1625           2
          82        -260        1675           2
          83        -260        1725           2
          84        -260        2375           2
          85        -260        2325           2
          86        -260        2275           2
          87        -260        2225           2
          88        -260        2175           2
          89        -260        2125           2
          96        -260        2075           2
          95        -260        2025           2
          94        -260        1975           2
          93        -260        1925           2
          92        -260        1875           2
          91        -260        1825           2
          90        -260        1775           2
          26       -1494         150           5
          27       -1494         200           5
          28       -1494         250           5
          29       -1494         300           5
          30       -1494         350           5
          31       -1494         400           5
          32       -1494         450           5
          25       -1494         500           5
          24       -1494         550           5
          23       -1494         600           5
          22       -1494         650           5
          21       -1494         700           5
          20       -1494         750           5
          19       -1494         100           5
          18       -1494          50           5
          17       -1504           0           5
          16       -1510          25           5
          15       -1514          75           5
          14       -1514         125           5
          13       -1514         775           5
          12       -1514         725           5
          11       -1514         675           5
          10       -1514         625           5
           9       -1514         575           5
           8       -1514         525           5
           7       -1514         475           5
           6       -1514         425           5
           5       -1514         375           5
           4       -1514         325           5
           3       -1514         275           5
           2       -1514         225           5
           1       -1514         175           5
          64       -1744         150           6
          63       -1744         200           6
          62       -1744         250           6
          61       -1744         300           6
          60       -1744         350           6
          59       -1744         400           6
          58       -1744         450           6
          57       -1744         500           6
          56       -1744         550           6
          55       -1744         600           6
          54       -1744         650           6
          53       -1744         700           6
          52       -1744         750           6
          51       -1744         100           6
          50       -1744          50           6
          49       -1754           0           6
          48       -1760          25           6
          47       -1764          75           6
          46       -1764         125           6
          45       -1764         775           6
          44       -1764         725           6
          43       -1764         675           6
          42       -1764         625           6
          41       -1764         575           6
          40       -1764         525           6
          33       -1764         475           6
          34       -1764         425           6
          35       -1764         375           6
          36       -1764         325           6
          37       -1764         275           6
          38       -1764         225           6
          39       -1764         175           6
         103        -764        1775           4
         102        -764        1825           4
         101        -764        1875           4
         100        -764        1925           4
          99        -764        1975           4
          98        -764        2025           4
          97        -764        2075           4
         104        -764        2125           4
         105        -764        2175           4
         106        -764        2225           4
         107        -764        2275           4
         108        -764        2325           4
         109        -764        2375           4
         110        -764        1725           4
         111        -764        1675           4
         112        -760        1625           4
         113        -754        1600           4
         114        -744        1650           4
         115        -744        1700           4
         116        -744        2350           4
         117        -744        2300           4
         118        -744        2250           4
         119        -744        2200           4
         120        -744        2150           4
         121        -744        2100           4
         122        -744        2050           4
         123        -744        2000           4
         124        -744        1950           4
         125        -744        1900           4
         126        -744        1850           4
         127        -744        1800           4
         128        -744        1750           4
          65        -514        1775           3
          66        -514        1825           3
          67        -514        1875           3
          68        -514        1925           3
          69        -514        1975           3
          70        -514        2025           3
          71        -514        2075           3
          72        -514        2125           3
          73        -514        2175           3
          74        -514        2225           3
          75        -514        2275           3
          76        -514        2325           3
          77        -514        2375           3
          78        -514        1725           3
          79        -514        1675           3
          80        -510        1625           3
          81        -504        1600           3
          82        -494        1650           3
          83        -494        1700           3
          84        -494        2350           3
          85        -494        2300           3
          86        -494        2250           3
          87        -494        2200           3
          88        -494        2150           3
          89        -494        2100           3
          96        -494        2050           3
          95        -494        2000           3
          94        -494        1950           3
          93        -494        1900           3
          92        -494        1850           3
          91        -494        1800           3
          90        -494        1750           3
          26       -2269         175           8
          27       -2269         225           8
          28       -2269         275           8
          29       -2269         325           8
          30       -2269         375           8
          31       -2269         425           8
          32       -2269         475           8
          25       -2269         525           8
          24       -2269         575           8
          23       -2269         625           8
          22       -2269         675           8
          21       -2269         725           8
          20       -2269         775           8
          19       -2269         125           8
          18       -2269          75           8
          17       -2265          25           8
          16       -2259           0           8
          15       -2249          50           8
          14       -2249         100           8
          13       -2249         750           8
          12       -2249         700           8
          11       -2249         650           8
          10       -2249         600           8
           9       -2249         550           8
           8       -2249         500           8
           7       -2249         450           8
           6       -2249         400           8
           5       -2249         350           8
           4       -2249         300           8
           3       -2249         250           8
           2       -2249         200           8
           1       -2249         150           8
          64       -2019         175           7
          63       -2019         225           7
          62       -2019         275           7
          61       -2019         325           7
          60       -2019         375           7
          59       -2019         425           7
          58       -2019         475           7
          57       -2019         525           7
          56       -2019         575           7
          55       -2019         625           7
          54       -2019         675           7
          53       -2019         725           7
          52       -2019         775           7
          51       -2019         125           7
          50       -2019          75           7
          49       -2015          25           7
          48       -2009           0           7
          47       -1999          50           7
          46       -1999         100           7
          45       -1999         750           7
          44       -1999         700           7
          43       -1999         650           7
          42       -1999         600           7
          41       -1999         550           7
          40       -1999         500           7
          33       -1999         450           7
          34       -1999         400           7
          35       -1999         350           7
          36       -1999         300           7
          37       -1999         250           7
          38       -1999         200           7
          39       -1999         150           7
          ];
      
shaftids = [str2double({probetype(12)}) str2double({probetype(13)}) str2double({probetype(14)}) str2double({probetype(15)})];    
s=[];     
s.channels = zeros(1,max(exceldata(:,1)));
s.x = zeros(1,max(exceldata(:,1)));
s.z = zeros(1,max(exceldata(:,1)));
s.shaft = zeros(1,max(exceldata(:,1)));


for shaftind = 1:length(shaftids)
    shaft = shaftids(shaftind);
    indices = find(exceldata(:,4)==shaft);
    channels = exceldata(indices,1);
    s.channels(channels')=channels;
    s.x(channels')=-1*exceldata(indices,2);   %the reference electrode is always the top right channel when the probes are pointing up.
    s.z(channels')=exceldata(indices,3);
    s.shaft(channels')=exceldata(indices,4);
end    
    s.tipelectrode=30;

% s.channels(1:64) = s.channels(1:64)+64;             %temporary solution to the switching of headstage positions.
% s.channels(65:128) = s.channels(65:128) - 64;
    
[a,sortorder]=sort(s.channels);
s.channels=s.channels(sortorder);
s.channels=s.channels';
s.x=s.x(sortorder);
s.x=s.x';
s.z=s.z(sortorder);
s.z=s.z';
s.shaft = s.shaft(sortorder);

% To plot the labeled channels:
figure(1)
close 1
figure(1)
plot(s.x,s.z,'.y')
for i=1:length(s.channels)
text(s.x(i),s.z(i),num2str(s.channels(i)),'FontSize',6)
end
axis equal
